# ------------------------------------------------
# Vari√°veis de Configura√ß√£o
# ------------------------------------------------

# Define a vari√°vel SUDO. Por padr√£o, ela √© vazia.
# O usu√°rio pode passar 'sudo' ou 'doas' via linha de comando (ex: make install SUDO=sudo)
SUDO ?= 

# Diret√≥rio de destino para defini√ß√µes de sintaxe (filedefs)
FILEDEFS_DIR := /usr/share/geany/filedefs
FILEDEFS_FILE := filedefs/filetypes.Prisma.conf

# Diret√≥rio de destino para templates de arquivos
TEMPLATES_DIR := /usr/share/geany/templates/files
TEMPLATES_FILES := templates/files/main.prisma

# ------------------------------------------------
# Regras Principais de Instala√ß√£o (Sistema)
# ------------------------------------------------

.PHONY: install uninstall

# Regra para instalar TODOS os arquivos do Geany
install:
	@echo "--------------------------------------------------------"
	@echo "  üö® Instalando configura√ß√µes do Geany. Requer privil√©gios de root."
	@echo "  Se seu sistema n√£o usa 'sudo', execute com seu comando (ex: make install SUDO=doas)"
	@echo "--------------------------------------------------------"
	
	# 1. Instalar o arquivo de defini√ß√£o de sintaxe (.conf)
	@echo "Instalando a defini√ß√£o de sintaxe em $(FILEDEFS_DIR)..."
	$(SUDO) mkdir -p $(FILEDEFS_DIR)
	$(SUDO) cp -v $(FILEDEFS_FILE) $(FILEDEFS_DIR)/
	
	# 2. Instalar os templates de arquivos
	@echo "Instalando templates em $(TEMPLATES_DIR)..."
	$(SUDO) mkdir -p $(TEMPLATES_DIR)
	$(SUDO) cp -v $(TEMPLATES_FILES) $(TEMPLATES_DIR)/
	
	@echo "‚úÖ Instala√ß√£o Geany conclu√≠da. Reinicie o Geany."

# Regra de Desinstala√ß√£o (Sistema)
uninstall:
	@echo "--------------------------------------------------------"
	@echo "  üö® Desinstalando configura√ß√µes do Geany. Requer privil√©gios de root."
	@echo "  Se seu sistema n√£o usa 'sudo', execute com seu comando (ex: make uninstall SUDO=doas)"
	@echo "--------------------------------------------------------"

	# 1. Remover o arquivo de defini√ß√£o de sintaxe
	@echo "Removendo a defini√ß√£o de sintaxe..."
	$(SUDO) rm -f $(FILEDEFS_DIR)/$(notdir $(FILEDEFS_FILE))
	
	# 2. Remover os templates de arquivos
	@echo "Removendo templates..."
	$(SUDO) rm -f $(TEMPLATES_DIR)/gui.prisma
	$(SUDO) rm -f $(TEMPLATES_DIR)/main.prisma
	
	@echo "üóëÔ∏è Remo√ß√£o Geany conclu√≠da."
