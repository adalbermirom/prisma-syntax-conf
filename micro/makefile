# Define o nome do arquivo de sintaxe e o diret√≥rio de origem
SYNTAX_FILE := syntax/prisma.yaml
INSTALL_NAME := prisma.yaml

# ------------------------------------------------
# Diret√≥rios de Instala√ß√£o Padr√£o do Micro
# ------------------------------------------------

# 1. Instala√ß√£o no Sistema (requer sudo)
# O diret√≥rio /usr/share/micro/ √© onde os arquivos de sintaxe globais s√£o armazenados.
SYSTEM_DIR := /usr/share/micro/syntax

# 2. Instala√ß√£o no Usu√°rio (local)
# O diret√≥rio ~/.config/micro/ √© onde o micro procura por configura√ß√µes e sintaxes locais.
USER_DIR := $(HOME)/.config/micro/syntax

# ------------------------------------------------
# Comandos Principais
# ------------------------------------------------

.PHONY: all install-user install-system uninstall clean

# Comando padr√£o - Instala apenas para o usu√°rio atual
all: install-user

# Instala√ß√£o local (~/.config/micro/syntax)
install-user:
	@echo "Criando o diret√≥rio de sintaxe do usu√°rio se n√£o existir..."
	@mkdir -p $(USER_DIR)
	@echo "Instalando $(INSTALL_NAME) em $(USER_DIR)..."
	cp $(SYNTAX_FILE) $(USER_DIR)/$(INSTALL_NAME)
	@echo "‚úÖ Instala√ß√£o conclu√≠da no diret√≥rio do usu√°rio. Reinicie o Micro."

# Instala√ß√£o no sistema (/usr/share/micro/syntax) - Requer sudo
install-system:
	@echo "--------------------------------------------------------"
	@echo "  üö® Aten√ß√£o: Esta opera√ß√£o requer privil√©gios de root (sudo)."
	@echo "--------------------------------------------------------"
	@echo "Criando o diret√≥rio de sintaxe do sistema se n√£o existir..."
	sudo mkdir -p $(SYSTEM_DIR)
	@echo "Instalando $(INSTALL_NAME) em $(SYSTEM_DIR)..."
	sudo cp $(SYNTAX_FILE) $(SYSTEM_DIR)/$(INSTALL_NAME)
	@echo "‚úÖ Instala√ß√£o conclu√≠da no diret√≥rio do sistema. Reinicie o Micro."

# ------------------------------------------------
# Comandos de Manuten√ß√£o
# ------------------------------------------------

# Remove a instala√ß√£o do usu√°rio
uninstall-user:
	@echo "Removendo $(INSTALL_NAME) do diret√≥rio do usu√°rio..."
	@rm -f $(USER_DIR)/$(INSTALL_NAME)
	@echo "üóëÔ∏è Remo√ß√£o conclu√≠da (local)."

# Remove a instala√ß√£o do sistema - Requer sudo
uninstall-system:
	@echo "--------------------------------------------------------"
	@echo "  üö® Aten√ß√£o: A desinstala√ß√£o do sistema requer sudo."
	@echo "--------------------------------------------------------"
	@echo "Removendo $(INSTALL_NAME) do diret√≥rio do sistema..."
	sudo rm -f $(SYSTEM_DIR)/$(INSTALL_NAME)
	@echo "üóëÔ∏è Remo√ß√£o conclu√≠da (sistema)."

# Remove tudo (usu√°rio e sistema)
uninstall: uninstall-user uninstall-system

# Comando de limpeza (n√£o remove bin√°rios, mas √© √∫til)
clean:
	@echo "Nenhuma limpeza necess√°ria para este projeto de sintaxe."
